<Project>
  <!-- Global properties for all projects -->
  <PropertyGroup>
    <!-- Disable proto generation in all benchmark projects -->
    <DisableProtobufDesignTimeBuild Condition="$(MSBuildProjectName.Contains('Benchmark')) OR $(MSBuildProjectName.Contains('benchmark'))">true</DisableProtobufDesignTimeBuild>
    <DisableProtoc Condition="$(MSBuildProjectName.Contains('Benchmark')) OR $(MSBuildProjectName.Contains('benchmark'))">true</DisableProtoc>
    <DisableGrpcCompile Condition="$(MSBuildProjectName.Contains('Benchmark')) OR $(MSBuildProjectName.Contains('benchmark'))">true</DisableGrpcCompile>
    
    <!-- Single source of truth for proto output directory -->
    <ProtoOutputDir>$(MSBuildThisFileDirectory)HubClient.Core/obj/$(Configuration)/$(TargetFramework)/ProtoGen</ProtoOutputDir>
    
    <!-- Disable proto generation in BenchmarkDotNet generated projects -->
    <DisableProtoBuildForBenchmarks Condition="'$(MSBuildProjectName.StartsWith(`BenchmarkDotNet.Autogenerated`))' == 'true'">true</DisableProtoBuildForBenchmarks>
    <SkipProtoBuild Condition="'$(DisableProtoBuildForBenchmarks)' == 'true'">true</SkipProtoBuild>
  </PropertyGroup>
  
  <!-- Special handling for BenchmarkDotNet generated projects -->
  <ItemDefinitionGroup Condition="'$(MSBuildProjectName.StartsWith(`BenchmarkDotNet.Autogenerated`))' == 'true'">
    <Protobuf>
      <CompileOutputs>false</CompileOutputs>
      <Generator>MSBuild:Compile</Generator>
    </Protobuf>
  </ItemDefinitionGroup>
  
  <!-- Especially disable in BenchmarkDotNet generated projects -->
  <PropertyGroup Condition="$(MSBuildProjectName.Contains('BenchmarkDotNet')) OR $(MSBuildProjectExtension) == '.notcs'">
    <DisableProtobufDesignTimeBuild>true</DisableProtobufDesignTimeBuild>
    <DisableProtoc>true</DisableProtoc>
    <DisableGrpcCompile>true</DisableGrpcCompile>
  </PropertyGroup>
</Project> 